<?php
var scripts = global.scripts = ['assets/index.js'],
	pages = [ 'home', 'chat', 'media', 'knowledgebase', 'contact', 'privacy' ],
	page = pages[Number((req.url.search + '').substr(1))] || pages[0],
	checksum = str => { var hash = 5381, i = str.length; while(i)hash = (hash * 33) ^ str.charCodeAt(--i); return hash >>> 0; },
	user_hash = checksum(req.url.host + req.real_ip).toString(),
	chars = 'abcdefghijklmnopqrstuvwxyz',
	real_char = 'zb' + user_hash.substr(1, 1),
	fake_char = 'zs' + user_hash.substr(2, 1),
	char_class = 'z1' + user_hash.substr(1, 1),
	zwsp = String.fromCharCode(0x200b),
	junk_classes = [];

for(var ind = 0; ind < user_hash.length; ind++)junk_classes.push(chars[chars.length % (ind == 0 ? 1 : ind)] + user_hash.substr(ind - 1, 1));

global.obfus = str => {
	var output = '';
	
	str.split(' ').forEach(word => (word.split('').forEach((char, ind) => {
		output += '<s class="' + char_class + '">';
		
		var junk = junk_classes[(junk_classes.length - 1) % (ind == 0 ? 1 : ind)];
		
		if(ind == word.length)output += char;
		else output += zwsp + '<s class="' + junk + '">' + junk + '</s><s class="' + fake_char + '">c</s><s class="' + real_char + '">' + char + '<s class="' + fake_char + '"></s></s><s class="' + fake_char + '"></s>';
		
		output += '</s>';
	}), output += ' '));
	
	return output;
};
?><!doctype html>
<html lang='en'>
	<head>
		<meta charset='utf-8' />
		<meta name='viewport' content='width=device-width, initial-scale=1.0' />
		<meta name='description' content='Web access service' />
		<title>Sy<?=zwsp?>ste<?=zwsp?>mYA</title>
		<link rel='stylesheet' href='/assets/index.css?<?=await filemtime('assets/index.css')?>' />
		<style>s{text-decoration:none}.<?=char_class?>{white-space:nowrap}.<?=fake_char?>,.<?=junk_classes.join(',.')?>{    position:absolute;z-index:-10;opacity:0}</style>
	</head>
	<body data-page='<?=page?>' data-appearance='<?=req.cookies.appearance || 'light'?>'>
		<nav>
			<div class='toggle'><s></s><s></s><s></s></div>
			<a href='/' class='entry icon'><svg width='100mm' height='100mm' viewBox='0 0 100 100'><g transform='rotate(-45 53.4 14.4)' fill='currentColor'><rect width='55' height='13' x='6' y='3' ry='1' rx='1'></rect><rect width='42' height='13' x='-45' y='6' ry='1' rx='1' transform='rotate(-90)'></rect></g><g transform='rotate(135 35.2 48.5)' fill='currentColor'><rect width='55' height='13' x='6' y='3' ry='1' rx='1'></rect><rect width='42' height='13' x='-45' y='6' ry='1' rx='1' transform='rotate(-90)'></rect></g></svg><span>Sys tim Ya</span></a>
			<div class='sep'></div>
			<div class='menu'>
				<a href='/?1' class='entry'><span>Chat</span></a>
				<a href='/?2' class='entry'><span>Media</span></a>
				<a href='/?3' class='entry'><span>Support</span></a>
			</div>
			<form class='search-bar' method='POST' action='/gateway'>
				<input name='url' class='bar' placeholder='Search the web' list='suggested' required />
				<datalist id='suggested'><option value='google.com'></option><option value='invidious.tube'></option><option value='wolframalpha.com'></option><option value='discord.com'></option><option value='reddit.com'></option><option value='1v1.lol'></option><option value='krunker.io'></option></datalist>
				<button type='submit' class='submit'><svg viewBox='0 0 512 512' width='26' height='26'><path d='M284 105.6c-19.9 3.5-33.8 8.8-47.7 18-21.7 14.4-39 38.5-45.3 63.3-7.7 30.5-2.8 61.8 13.8 87.7 2.9 4.5 5.2 8.5 5.2 9 0 .4-23.1 24-51.4 52.4-56.3 56.4-54.6 54.3-51.5 62.8 1.1 2.8 2.5 4.3 6.2 6.1 8.4 4.2 7 5.3 63.7-51.4 29.4-29.4 51.2-50.5 52.3-50.5 1 0 4.5 1.9 7.9 4.1 8.7 5.9 21.4 11.6 32.6 14.6 8.6 2.4 11.6 2.7 27.2 2.7 14.8.1 18.8-.3 26-2.1 41.4-10.5 72.8-42.6 82.1-83.8 2.8-12.9 3.1-32.1.5-44.5-3.7-17.5-10.3-31.8-21.7-47-14.2-18.9-36.6-33.2-60.9-39-9.1-2.2-32.2-3.6-39-2.4zm36 27.4c23.6 6.7 44 23.9 54.5 46.1 5.5 11.7 7.5 21.2 7.5 35.9 0 16-2.1 24.7-9.2 39-4.6 9.3-6.4 11.7-15.3 20.5-11.4 11.4-19.6 16.5-34.5 21.7-9.2 3.1-10 3.2-25.5 3.2-15.3 0-16.4-.1-25.5-3.2-15-5-23.1-10.1-34.6-21.6-9-9-10.7-11.3-15.3-20.6-7.1-14.4-9.1-23.1-9.1-39 0-15.9 2-24.6 9.1-39 4.7-9.4 6.3-11.6 15.3-20.6 8.4-8.3 11.7-10.8 19.3-14.7 11.3-5.8 15.8-7.5 24.8-9.3 9.9-1.9 28.8-1.2 38.5 1.6z' fill='currentColor'/></button>
				<button class='cancel'><svg width='28' height='28' viewBox='0 0 20 20' class='c01190'><path d='M9.16 16.37a.5.5 0 10.67-.74L3.67 10H17.5a.5.5 0 000-1H3.67l6.16-5.63a.5.5 0 00-.67-.74L2.24 8.94a.75.75 0 000 1.11l6.92 6.32z' transform='matrix(-1, 0, 0, -1, 20.00043, 20.000115)' fill='currentColor'></path></svg></button>
			</form>
			<div class='shift-right'></div>
			<svg class='button-svg search' viewBox='0 0 512 512'><path d='M284 105.6c-19.9 3.5-33.8 8.8-47.7 18-21.7 14.4-39 38.5-45.3 63.3-7.7 30.5-2.8 61.8 13.8 87.7 2.9 4.5 5.2 8.5 5.2 9 0 .4-23.1 24-51.4 52.4-56.3 56.4-54.6 54.3-51.5 62.8 1.1 2.8 2.5 4.3 6.2 6.1 8.4 4.2 7 5.3 63.7-51.4 29.4-29.4 51.2-50.5 52.3-50.5 1 0 4.5 1.9 7.9 4.1 8.7 5.9 21.4 11.6 32.6 14.6 8.6 2.4 11.6 2.7 27.2 2.7 14.8.1 18.8-.3 26-2.1 41.4-10.5 72.8-42.6 82.1-83.8 2.8-12.9 3.1-32.1.5-44.5-3.7-17.5-10.3-31.8-21.7-47-14.2-18.9-36.6-33.2-60.9-39-9.1-2.2-32.2-3.6-39-2.4zm36 27.4c23.6 6.7 44 23.9 54.5 46.1 5.5 11.7 7.5 21.2 7.5 35.9 0 16-2.1 24.7-9.2 39-4.6 9.3-6.4 11.7-15.3 20.5-11.4 11.4-19.6 16.5-34.5 21.7-9.2 3.1-10 3.2-25.5 3.2-15.3 0-16.4-.1-25.5-3.2-15-5-23.1-10.1-34.6-21.6-9-9-10.7-11.3-15.3-20.6-7.1-14.4-9.1-23.1-9.1-39 0-15.9 2-24.6 9.1-39 4.7-9.4 6.3-11.6 15.3-20.6 8.4-8.3 11.7-10.8 19.3-14.7 11.3-5.8 15.8-7.5 24.8-9.3 9.9-1.9 28.8-1.2 38.5 1.6z' fill='currentColor'/></svg>
			<div class='button-svg settings'>
				<svg viewBox="0 0 24 24"><path d='M12.0124778 2.2500498a10.582377 10.582377 0 012.1815115.2530381c.3127415.069747.5466305.3304729.5821301.6489249l.1702047 1.5268445c.0770406.7010523.6689451 1.2320337 1.3746034 1.2327735.1896719.0002964.3772961-.0392034.5525656-.116748l1.4006234-.615274c.2913066-.1279667.6316536-.0582008.8491197.1740568 1.0121801 1.081026 1.7660064 2.377533 2.2047578 3.7919668.0946085.3049958-.0142802.6364504-.2713294.8259205l-1.2414802.91509c-.3541398.2601966-.5632965.6734118-.5632965 1.112863 0 .4394511.2091567.8526664.5640752 1.1134358l1.242553.9154075c.2571381.1894374.3660979.5209379.2714917.825989-.4385886 1.4141989-1.1919863 2.7106059-2.2035811 3.7918063-.2172663.2322159-.5573604.3021683-.8486388.1745528l-1.4063326-.6161458c-.4023179-.1760597-.8643902-.1502677-1.2446153.069472-.3802252.2197397-.6332669.6072263-.6815858 1.0437587l-.1690752 1.5266796c-.0348634.3148017-.2637233.5737691-.5718489.647078-1.4484493.3446136-2.9575447.3446136-4.405994 0-.3081257-.0733089-.5369855-.3322763-.5718489-.647078l-.168822-1.5244241c-.0495879-.435702-.3030199-.8220112-.682936-1.0410066-.379916-.2189953-.8412214-.244683-1.2422244-.0696059l-1.4066261.6162743c-.291354.1276487-.6315394.0576243-.8487924-.174717-1.0121572-1.0824519-1.765588-2.3803975-2.2035811-3.7961398-.0943386-.3049343.0146608-.6361688.2716453-.8254931l1.2433317-.9159803c.3541399-.2601966.5632965-.6734119.5632965-1.112863s-.2091566-.8526664-.5637598-1.1132037l-1.2425531-.914407c-.2573656-.1893979-.3664653-.5210645-.2717941-.8262627.4387514-1.4144338 1.1925777-2.710941 2.2047579-3.7919669.217466-.2322575.557813-.3020235.8491196-.1740567l1.4003752.615165c.4029419.1768328.86618.1501214 1.2481506-.0730334.3803198-.2206038.633516-.6084687.682397-1.045049l.1700757-1.5256791c.0355175-.318613.2696197-.5794224.5825603-.6490207.717274-.1595225 1.4491477-.2442886 2.2013698-.2529423zm.0001869 1.4998982a9.1364025 9.1364025 0 00-1.3545365.117117l-.1089304.9771696c-.1018296.909493-.6288599 1.7168372-1.418474 2.1748472-.794448.4641411-1.7630567.5199934-2.6058371.1501353l-.8982898-.3946059c-.5719328.694165-1.0271518 1.4767924-1.3477716 2.3171213l.7977987.587108c.73881.5428247 1.1751547 1.4048785 1.1751547 2.3216658s-.4363447 1.7788411-1.174376 2.3210929l-.799053.5886743c.3203404.8418097.7756315 1.6259003 1.3479553 2.3214039l.9051323-.3965582c.8380927-.365911 1.8001098-.3123413 2.5923958.1443568.792286.4566982 1.320799 1.2623163 1.4244639 2.1731951l.1089608.9838708c.8896442.1512775 1.7985063.1512775 2.6881505 0l.108956-.9838272c.1007932-.9106073.6286914-1.7189857 1.4219209-2.1774088.7932295-.4584232 1.7572092-.5122307 2.5968224-.1448048l.9044175.3962455c.5718049-.6944194 1.0269127-1.4772389 1.3474599-2.3177189l-.7979423-.587856c-.7388101-.5428247-1.1751548-1.4048785-1.1751548-2.3216658s.4363447-1.7788411 1.1742267-2.3209829l.7968828-.5873797c-.3206284-.840485-.7759028-1.6232549-1.3479292-2.3175333l-.8964725.3938058c-.3653344.1616412-.7605171.2448376-1.1596266.2442137-1.4696846-.0015407-2.7031274-1.1080285-2.8635399-2.5677539l-.1089258-.9771283c-.4455319-.0725002-.8935634-.1115785-1.3338387-.1167993zM12 8.25c2.0710678 0 3.75 1.6789322 3.75 3.75s-1.6789322 3.75-3.75 3.75S8.25 14.0710678 8.25 12 9.9289322 8.25 12 8.25zm0 1.5c-1.2426407 0-2.25 1.0073593-2.25 2.25s1.0073593 2.25 2.25 2.25 2.25-1.0073593 2.25-2.25S13.2426407 9.75 12 9.75z' fill='currentColor'/></svg>
				<div class='popup'>
					<div class='item appearance'>
						<svg viewBox='0 0 24 24'><path d='M280.485281,201.514719 L284,198 L287.514719,201.514719 L292.485281,201.514719 L292.485281,206.485281 L296,210 L292.485281,213.514719 L292.485281,218.485281 L287.514719,218.485281 L284,222 L280.485281,218.485281 L275.514719,218.485281 L275.514719,213.514719 L272,210 L275.514719,206.485281 L275.514719,201.514719 L280.485281,201.514719 Z M283.726536,215.86375 C287.116026,215.86375 289.86375,213.251451 289.86375,210.029016 C289.86375,206.806581 287.116026,204.194281 283.726536,204.194281 C283.073662,204.194281 282.164855,204.396254 281.000116,204.800201 C282.532112,206.378393 283.29811,208.121331 283.29811,210.029016 C283.29811,211.9367 282.444938,213.635948 280.738594,215.126758 C282.007413,215.618086 283.003393,215.86375 283.726536,215.86375 Z' transform='translate(-272, -198)' fill='currentColor'></path></svg>
						<span><?php
						var mode = req.cookies.appearance || 'dark';
						
						echo(mode[0].toUpperCase() + mode.substr(1));
						?> mode</span>
					</div>
				</div>
			</div>
		</nav><?php
		await include('cgi/' + page + '.php');
		?><footer>
			<a href='/?4'>Contact</a>
			<a href='/?5'>Privacy Policy</a>
			<span><?=global.obfus('SystemYA')?> 2021</span>
		</footer>
		<div class='frame service'>
			<div class='buttons'>
				<div class='button reload'><svg height='24' viewBox='0 0 24 24' width='24'><path d='M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z' fill='currentColor'/></svg></div>
				<div class='button close'><svg height='24' viewBox='0 0 24 24' width='24'><path d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z' fill='currentColor'/></svg></div>
			</div>
			<iframe class='fill'></iframe>
		</div>
		<?=scripts.map(file => '<script src=' + JSON.stringify(file + '?ts=' + filemtime(file)) + '></script>').join('\n')?>
	</body>
</html>